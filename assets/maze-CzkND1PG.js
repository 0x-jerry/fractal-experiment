var M=Object.defineProperty;var R=(e,t,s)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var y=(e,t,s)=>(R(e,typeof t!="symbol"?t+"":t,s),s),C=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var r=(e,t,s)=>(C(e,t,"read from private field"),s?s.call(e):t.get(e)),z=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},m=(e,t,s,o)=>(C(e,t,"write to private field"),o?o.call(e,s):t.set(e,s),s);import{u as S,a as V,_ as b}from"./useCanvasRunner-BtSyTrXL.js";import{c as G}from"./utils-DWuipzrQ.js";import{R as B}from"./pseudorandom-9FEvop_2.js";import{V as n}from"./vec2-ikhXc4Ii.js";import{d as U,o as k,c as D,w as L,a as N,u as A}from"./index-B1bq4_oz.js";var p=(e=>(e[e.Up=1]="Up",e[e.Down=2]="Down",e[e.Left=4]="Left",e[e.Right=8]="Right",e))(p||{});class O extends n{constructor(){super(...arguments);y(this,"wall",0)}}class v extends Array{constructor(t){const s=t.x*t.y;super(s),this.size=t;for(let o=0;o<s;o++){const l=o%t.x,i=Math.floor(o/t.x);this[o]=new O(l,i)}}get(t,s){if(t<0||t>=this.size.x||s<0||s>=this.size.y)return;const o=s*this.size.x+t;return this.at(o)}}var c,h,f;class j{constructor(t=n.zero){y(this,"map");y(this,"random",B());z(this,c,new Set);z(this,h,new Array);z(this,f,void 0);this.map=new v(t)}setSize(t){this.map=new v(t)}get current(){return r(this,f)}isVisited(t){return r(this,c).has(t)}*createGenerator(t){for(r(this,c).clear(),m(this,f,this.map.get(0,0)),m(this,h,[r(this,f)]),r(this,c).add(r(this,f));r(this,h).length;){t==null||t(),yield,m(this,f,r(this,h).at(-1));const s=this.getNextCell(r(this,f));s?(r(this,h).push(s),r(this,c).add(s)):r(this,h).pop()}m(this,f,void 0),t==null||t()}getNextCell(t){const s={1:n.up,2:n.down,4:n.left,8:n.right},o=Object.entries(s).map(([u,w])=>{const d=n.from(t).add(w),a=this.map.get(d.x,d.y);if(a&&!r(this,c).has(a))return{wall:+u,cell:a}}).filter(Boolean),l=Math.floor(this.random(0,o.length)),i=o.at(l);if(i)return t.wall=t.wall|i.wall,i.cell}}c=new WeakMap,h=new WeakMap,f=new WeakMap;function E(e,t){const s=new j(t.size),o=new n(t.size.x*2+1,t.size.y*2+1),l=new n(e.canvas.width,e.canvas.height),i=new n(l.x/o.x,l.y/o.y),u=(a,x)=>{const _=(a.x*2+1+x.x)*i.x,g=(a.y*2+1+x.y)*i.y;e.fillStyle=t.color,e.fillRect(_,g,i.x,i.y)},w=(a,x)=>{const _=(a.x*2+1)*i.x,g=(a.y*2+1)*i.y;e.fillStyle=x,e.fillRect(_,g,i.x,i.y)};return s.createGenerator(()=>d());function d(){e.fillStyle=t.wallColor,e.fillRect(0,0,l.x,l.y),s.map.forEach(a=>{a===s.current?w(a,"#ff0000"):s.isVisited(a)?w(a,t.color):w(a,t.wallColor),a.wall&p.Up&&u(a,n.up),a.wall&p.Down&&u(a,n.down),a.wall&p.Left&&u(a,n.left),a.wall&p.Right&&u(a,n.right)})}}const Q=U({__name:"maze",setup(e){const t=S({color:"#ffffff",wallColor:"#6fbbdb",x:{_:!0,min:10,max:100,value:50,step:1},y:{_:!0,min:10,max:100,value:30,step:1},redraw:()=>o()}),s=V(l=>{G(l);const i=t.value;return E(l,{color:i.color,wallColor:i.wallColor,size:{x:i.x,y:i.y}})});s.emitter.on("done",()=>{console.log("done")});async function o(){s.recreate()}return(l,i)=>(k(),D(b,{title:"Maze Generator"},{default:L(()=>[N("div",{ref:A(s).ctx.ref,class:"w-full h-full"},null,512)]),_:1}))}});export{Q as default};
